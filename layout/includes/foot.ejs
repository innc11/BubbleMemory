	<!-- Footer -->
	<footer class="footer">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="copyright">
                        <%- theme.footer_text %>
						<br>
						<div>
							<% if(theme.site_running_time.enabled) { %>
							<div id="SiteRunningTime" start-time="<%- theme.site_running_time.since %> " format="<%- theme.site_running_time.format %> " auto-refresh="<%- theme.site_running_time.refresh %> ">
								<style onload="$(function(){SiteRunningTime();})"></style>
							</div> | <% } %>Theme <a href="https://github.com/innc11/BubbleMemory" class="footer-link">BubbleMemory</a> modified from <a href="https://github.com/trinitrotofu/Bubble" class="footer-link">Bubble</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<%- theme.pjax? '</div>':'' %>

	<!--To Top Button-->
	<a id="scrollup" href="#" style="display: none;">
		<button id="scrollbtn" class="btn btn-icon-only rounded-circle btn-secondary scrollup-btn">
			<span class="btn-inner--icon"><i class="fa fa-arrow-up" aria-hidden="true"></i></span>
		</button>
	</a>

	<!-- Core -->
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>

	<!-- Optional plugins -->
	<script src="https://cdn.jsdelivr.net/npm/headroom.js@0.11.0/dist/headroom.min.js"></script>

	<!-- Theme JS -->
	<script src="<%- url_for('js/argon.min.js') %>"></script>
	<script src="<%- url_for('js/bbrender.js') %>"></script>

	<!-- SiteRunningTime js -->
	<script src="<%- url_for('more/SiteRunningTime.js') %>"></script>

	<!-- scrollup -->
	<script>
		$(function(){
			var scrollBottom = parseInt($("#adminbtn").css("bottom")) + parseInt($("#adminbtn").css("height")) + 25;
			$("#scrollbtn").css("bottom", scrollBottom);
			var resizeTimer;
			$(window).resize(function(e) {
				if ($("#adminbtn").length > 0)
				{
					clearTimeout(resizeTimer);
					resizeTimer = setTimeout(function() {
						scrollBottom = parseInt($("#adminbtn").css("bottom")) + parseInt($("#adminbtn").css("height")) + 25;
						$("#scrollbtn").css("bottom", scrollBottom);
					}, 250);
				}
			});
			var scrollLock = 0;
			if ($(window).scrollTop() > 500) $("#scrollup").fadeIn(400);
			$(window).scroll(function() {
				if (!scrollLock)
				{
					if ($(window).scrollTop() > 500) $("#scrollup").fadeIn(400);
					else $("#scrollup").fadeOut(400);
				}
			});
			$("#scrollup").click(function() {
				scrollLock = 1;
				$("#scrollup").fadeOut(400);
				$("html,body").animate({scrollTop: "0px"}, 500, function() {
					scrollLock = 0;
				});
			});
		});
	</script>

	<!-- Pjax -->
	<script>
		function init() {
			<% if (theme.prismjs && theme.prism_line_numbers) { %>
                var pres = document.querySelectorAll('pre');
                var lineNumberClassName = 'line-numbers';
                pres.forEach(function (item, index) {
                    item.className = item.className == '' ? lineNumberClassName : item.className + ' ' + lineNumberClassName;
                });
                Prism.highlightAll(false,null);
            <% } %>
            
			$("img").Lazy({
                threshold: 700,
                effect: 'fadeIn',
                effectTime: 1000,
                defaultImage: "<%- url_for('images/loading.gif') %>"
            });

            $("div[data-src]").Lazy({
                threshold: 700,
                effect: 'fadeIn',
                placeholder: "<%- url_for('images/loading.gif') %>",
                effectTime: 1000
            });

			<% if (theme.katex) { %>
                try {
                    renderMathInElement(document.body,{
                        delimiters: [
                            {left: "$$", right: "$$", display: true},
                            {left: "$", right: "$", display: false}
                        ]
                    })
                }catch{}
            <% } %>
			parseBbcode()
			parseBblink()
            <% if (theme.pjax) { %>
				<%- theme.pjax_callback %>
				try{ window.onload() }catch{}
            <% } %>

			setTimeout(() => {
				// $('.content').viewer({
				// 	url: 'data-src'
				// })

				$('div.content-article .section .container, .index-avatar').viewer({
					url: 'src'
				})
			},300)
        }
        
		function destroy(){
			// viewerjs
			// var viewer = $('.content').data('viewer');
			var viewer = $('div.content-article .section .container, .index-avatar').data('viewer');
			
			if(viewer){
				viewer.destroy()
			}
		}
		window.addEventListener("popstate", function(e) {
			setTimeout(() => {
				// $('.content').viewer({
				// 	url: 'data-src'
				// })

				$('div.content-article .section .container, .index-avatar').viewer({
					url: 'src'
				})
			},300)
		}, false);
    </script>
    
    <% if (theme.pjax) { %>
		<!-- Jquery Pjax -->
        <script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.js"></script>
        <script src="<%- url_for('js/progress.js') %>"></script>
        <script>
            var pgid = 0
            $(document).pjax('a[href^="<%- config.url %>"]:not(a[target="_blank"], a[no-pjax])',
            {
                container: '#pjax-container',
                fragment: '#pjax-container',
                timeout: 8000
            }).on('pjax:send', function() {
                pgid = start_progress()
                $(".black-cover").fadeIn(400)
                $('html,body').animate({ scrollTop: $('html').offset().top}, 500)

                destroy()
            }).on('pjax:complete', function() {
                $(".black-cover").fadeOut(400)
                stop_progress(pgid)
                init()
                
            })
            $("#search").submit(function() {
                console.log('todo')
				/*
				todo 搜索
                var att = $(this).serializeArray()
                for(var i in att){
                    if(att[i].name=="s"){
                        $.pjax({url: <!php if ($this->options->rewrite): !>"<!php $this->options->siteUrl(); !>search/"+att[i].value+"/"<!php else: !>"<!php $this->options->siteUrl(); !>index.php/search/"+att[i].value+"/"<!php endif; !>, container: '#pjax-container',fragment: '#pjax-container',timeout:8000})
                    }
                }
                */
                return false
            })
        </script>
        <div class="black-cover" style="display: none;"></div>
    <% } %>

    <!-- KaTeX JS -->
    <% if (theme.katex) { %>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
	<% } %>

    <!-- Prism JS -->
    <% if (theme.prismjs) { %>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/components/prism-core.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/show-language/prism-show-language.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
        <% if (theme.prism_line_numbers) { %>
            <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <% } %>
    <% } %>

	<!-- Alert -->
	<div id="modal-notification" class="modal fade show" id="modal-notification" style="z-index: 102;display: none;">
		<div class="modal-dialog modal-sm">
			<div class="modal-content">
				<div class="modal-header">
					<h5 id="msgMain" class="modal-title" id="mySmallModalLabel"></h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="$('#modal-notification').hide('normal');">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div id="msgDetail" class="modal-body"></div>
			</div>
		</div>
	</div>
	<script>
		function alert(main,detail){
			$("#msgMain").html(main)
			if(detail) $("#msgDetail").html(detail)
			else $("#msgDetail").html("")
			$("#modal-notification").show("normal");
		}
		init()
	</script>
	
	<!-- More footer -->


	
	</body>
</html>